# ai_imu_dr_wxm_test
用于自己调试的版本．

#编译及运行示例参考　ai-imu-dr-README.md



# TODO
1. AI-IMU-Dead-reckoning
　　用MesNet网络来训练，观测速度的噪声．
　　已知加速度和角速度的噪声．
　　模型采用CalibredModel来进行IMU积分，得到状态量xk=(R,P,v,bias_a,bias_g, Tcb)

运动方程：　xk+1 = f(xk,u)+wn   状态量的预测，由上一时刻的状态，加上输入量（加速度＋角速度）,得到下一时刻的状态量
观测方程：　vc = 0 + nc　　适用于汽车这样的只朝前走的物体．伪观测量为朝上和朝右的速度，等于0.　其观测噪声不知道，则通过网络来训练得到．

网络的输入：　加速度和角速度，6个数．
网络的输出：　速度的观测噪声，2个方向的速度，因此输出为两个数．

网络结构MesNet：　2层CNN,　6(输入)-> 32 -> 32 ->2(输出)



2. 想要的改进（同样给定加速度和角速度的测量噪声，Allan方差得到）
　　(1) 用真值pose数据（例如Vicon）加上一定的噪声作为观测，构建IEKF．
    (2) 用相机的pose作为观测，观测噪声采用链式法则，由重投影误差的噪声，传播到位姿的噪声．再构建IEKF.

对于方案1：CalibratedModel
　　运动方程不变
　　观测方程：　
　　　　观测数据的获取：需要连续时间下的位姿，和IMU的帧率一致，因此，如果Vicon的帧率不够，可以采用Ｂ样条拟合的方式；噪声加高斯噪声．
　　　　观测方程的构建： xk+1中的R = R + n, P = P + n, 用ＭesNet网络来训练噪声n.　注意：需要看怎么保证Ｒ正交．
网络的输入：　加速度和角速度，6个数
网络的输出：　pose的观测噪声，6个数
网络结构MesNet：　2层CNN,　6(输入)-> 32 -> 32 ->6(输出)
网络残差： 与AI-IMU-DeadReckoning一致，采用真实数据，没有人为增加噪声．

也可以尝试将速度也作为观测，也训练速度的观测噪声．

对于方案二：
　　与方案一的区别在于，观测数据直接为ORB-SLAM3的单目位姿，噪声可以通过链式法则获得．尺度可以通过与VICON的真实轨迹进行对齐得到．
　　观测方程同样为：　xk+1中的R = R + n, P = P + n, 用ＭesNet网络来训练噪声n.　
预估实验结果得到的观测噪声应该比方案1中的观测噪声偏大一些．


3. 从Kalibr的启发
kalibr之前的实验结果表明：　calibrated模型在给定的Allan噪声下，标定不出来外参．但是在scale-misalignment模型下，可以标定出来．
说明，加速度和角速度的噪声更适用于scale-misalignment模型．

可以尝试的实验：
(1) 用scale-misalignment模型对原始imu数据进行矫正，矫正后，用Allan噪声，标定，是否可以标定出来外参？
(2) ORB-SLAM3加入scale-misalignment模型．看imu初始化是否能成功？


